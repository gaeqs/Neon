#version 460
#extension GL_EXT_mesh_shader: enable

const int PRIMITIVES = 32;
const int VERTICES = PRIMITIVES * 3;

layout (local_size_x = 1, local_size_y = 1, local_size_z = 1) in;

layout(set = 2, binding = 1) uniform Properties {
    int verticesAmount;
};

void main()
{
    int primitives = verticesAmount / 3;// Always multiple of 3.

    int groups = primitives / PRIMITIVES; // Each mesh shader generates 32 primitives
    int remainder = primitives % PRIMITIVES;
    if (remainder > 0) ++groups;

    EmitMeshTasksEXT(groups, 1, 1);
}
    